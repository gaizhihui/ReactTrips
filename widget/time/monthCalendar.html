<!DOCTYPE html>
<!--HTML5 doctype-->
<html>	
	<head>
		<title>TIME</title>
		<meta name="full-screen" content="yes">
		<meta name="browsermode" content="application">
		<meta name="x5-orientation" content="portrait">
		<meta name="x5-fullscreen" content="true">
		<meta name="x5-page-mode" content="app">
		<meta http-equiv="Content-type" content="text/html; charset=utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, minimal-ui">
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<script src="../script/pengCmp/coreXP.js"></script>
		<script src="js/jq.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/mrt-monthYm.js" type="text/javascript" charset="utf-8"></script>
		<link rel="stylesheet" type="text/css" href="css/mrt-time.css"/>
	</head>
	<style>
		div.mrt-hour, div.mrt-minite, div.mrt-year {
			position: absolute;
			top:0;
			overflow:hidden;
		}
		div.mrt-minite {
			width:15%;
			right:10%; 
		}
		div.mrt-year{
			left:39%;
			text-align: center;
			width: 10%;
			height: 250px;
			overflow: auto;
		} 
		div.mrt-hour{
			left:60%;
		}
		ul.mrt-hour {
			position: absolute;
			z-index: 99999999999999999; 
			left:50%;
		}
		ul.mrt-minite {
			position: absolute;
			z-index: 999999999999999999; 
			right:20%;
		}
	</style>
	<body>
		<div class="filter"></div>
		<div class="time-mrt">
			<p class="mrt-c">
				<span onclick="canncelDate()">取消</span>
				<span onclick="showDate()">确认</span>
			</p>
			<div class="all-out">
				<div class="border"></div>
				<ul class="mrt-date">
					<li><span></span></li> 
					<li><span></span></li> 
					<!--<li><span text="1960">1960</span></li> 
					<li><span text="1961">1961</span></li>
					<li><span text="1962">1962</span></li>
					<li><span text="1963">1963</span></li>
					<li><span text="1964">1964</span></li>
					<li><span text="1965">1965</span></li>
					<li><span text="1966">1966</span></li>
					<li><span text="1967">1967</span></li>
					<li><span text="1968">1968</span></li>
					<li><span text="1969">1969</span></li>
					<li><span text="1970">1970</span></li>
					<li><span text="1971">1971</span></li>
					<li><span text="1972">1972</span></li>
					<li><span text="1973">1973</span></li>
					<li><span text="1974">1974</span></li>
					<li><span text="1975">1975</span></li>
					<li><span text="1976">1976</span></li>
					<li><span text="1977">1977</span></li>
					<li><span text="1978">1978</span></li>
					<li><span text="1979">1979</span></li>
					<li><span text="1980">1980</span></li>
					<li><span text="1981">1981</span></li>
					<li><span text="1982">1982</span></li>
					<li><span text="1983">1983</span></li>
					<li><span text="1984">1984</span></li>
					<li><span text="1985">1985</span></li>
					<li><span text="1986">1986</span></li>
					<li><span text="1987">1987</span></li>
					<li><span text="1988">1988</span></li>
					<li><span text="1989">1989</span></li>
					<li><span text="1990">1990</span></li>
					<li><span text="1991">1991</span></li>
					<li><span text="1992">1992</span></li>
					<li><span text="1993">1993</span></li>
					<li><span text="1994">1994</span></li>
					<li><span text="1995">1995</span></li>
					<li><span text="1996">1996</span></li>
					<li><span text="1997">1997</span></li>
					<li><span text="1998">1998</span></li>
					<li><span text="1999">1999</span></li>
					<li><span text="2000">2000</span></li>
					<li><span text="2001">2001</span></li>
					<li><span text="2002">2002</span></li>
					<li><span text="2003">2003</span></li>
					<li><span text="2004">2004</span></li>
					<li><span text="2005">2005</span></li>
					<li><span text="2006">2006</span></li>
					<li><span text="2007">2007</span></li>
					<li><span text="2008">2008</span></li>
					<li><span text="2009">2009</span></li>
					<li><span text="2010">2010</span></li>
					<li><span text="2011">2011</span></li>
					<li><span text="2012">2012</span></li>
					<li><span text="2013">2013</span></li>
					<li><span text="2014">2014</span></li>
					<li><span text="2015">2015</span></li>
					<li><span text="2016">2016</span></li>
					<li><span text="2017">2017</span></li>
					<li><span text="2018">2018</span></li>
					<li><span text="2019">2019</span></li>
					<li><span text="2020">2020</span></li>
					<li><span></span></li> 
					<li><span></span></li>-->
				</ul>
				
				<div class="mrt-year" >
					<span style="color:#000000;width:100%;display:block;line-height:50px;height:50px;position:absolute;top:50%;left:0;margin-top:-25px;z-index:99999">年</span>
				</div>
				<ul class="mrt-hour">
				    <li><span></span></li> 
					<li><span></span></li> 
					<!--<li><span text="1">01</span></li> 
					<li><span text="2">02</span></li> 
					<li><span text="3">03</span></li> 
					<li><span text="4">04</span></li> 
					<li><span text="5">05</span></li> 
					<li><span text="6">06</span></li> 
					<li><span text="7">07</span></li> 
					<li><span text="8">08</span></li> 
					<li><span text="9">09</span></li> 
		
					<li><span></span></li> 
					<li><span></span></li>--> 
				</ul> 
				<ul class="mrt-hour" hidden>
				    <li><span></span></li> 
					<li><span></span></li> 
					<li><span text="1">01</span></li> 
					<li><span text="2">02</span></li> 
					<li><span text="3">03</span></li> 
					<li><span text="4">04</span></li> 
					<li><span text="5">05</span></li> 
					<li><span text="6">06</span></li> 
					<li><span text="7">07</span></li> 
					<li><span text="8">08</span></li> 
					<li><span text="9">09</span></li> 
					<li><span text="10">10</span></li> 
					<li><span text="11">11</span></li> 
					<li><span text="12">12</span></li> 
					<li><span></span></li> 
					<li><span></span></li>
				</ul> 
				
				
				<div class="mrt-hour" >
					<span style="color:#000000;width:100%;display:block;line-height:50px;height:50px;position:absolute;top:50%;left:0;margin-top:-25px;z-index:99999">月</span>
				</div>
				
			</div>
		</div>
		<script type="text/javascript">
		
		    var date  = new Date();
		    var year  = date.getFullYear();
		    var month = date.getMonth()+1;
		    var day   = date.getDay();
		    nowYear   = date.getFullYear();
		    
		   
		    //遍历年
		    for(var y=2010;y<=year;y++){
		    	     $(".mrt-date").append('<li><span text="'+y+'">'+y+'</span></li> ');
		    	}
		    $(".mrt-date").append('<li><span></span></li>').append('<li><span></span></li>');
		  
		    for(var y=1;y<=month;y++){
		    	    if(y<10){
		    	    	   m = 0+""+y;
		    	    }else{
		    	    	   m = y;
		    	    }
		    	    $(".mrt-hour").eq(0).append('<li><span text="'+y+'">'+m+'</span></li>');
		    }
		    $(".mrt-hour").eq(0).append('<li><span></span></li>').append('<li><span></span></li>');
		    
		    
			var setDateText = "2017-01-21 08:22:25";
			var setDate = function(setDateText) {
				if (setDateText != "" && typeof (setDateText) != "undefined") {
					var date = (setDateText.split(" ")[0].split("-"));
					var time = (setDateText.split(" ")[1].split(":"));
					$("#_" + date[1] + "_" + date[2]).addClass("selected").siblings().removeClass("selected");
					$("#hour" + time[0]).addClass("selected").siblings().removeClass("selected");
					$("#minite" + time[1]).addClass("selected").siblings().removeClass("selected");
					var offsetTop = ($("#_" + date[1] + "_" + date[2]).position().top);
					$("ul.mrt-date").animate({
						"scrollTop" : offsetTop - 100
					});
					setTimeout(function() {
						$("ul.mrt-hour").animate({
							"scrollTop" : 50 * (parseInt(time[0]))
						});
						if (parseInt(time[1]) % 5 != 0) {
							var intTime = parseInt(parseInt(time[1]) / 5) + 1
						}
						$("ul.mrt-minite").animate({
							"scrollTop" : 50 * intTime
						});
					}, 300)
				} else {
					alert("请上传时间，格式yyyy-mm-dd hh:mm");
				}
			};
			
			$(".filter").click(function(){
				var selectedDateObj  = {};
				selectedDateObj.oper = "";
				window.trigp.sendParam(JSON.stringify(selectedDateObj));
			});
			    	 
		    if(month < 10){
		    	   ms = 0 + "" + month;
		    }else{
		    	   ms = month;
		    }
		    /*setTimeout(function(){
		    	    getResult('{"date":"2017-04-10"}');
		    },1000);*/
            //getResult('{"date":"2018-02-10"}');
		    //getResult('{"date":"'+year+'-'+ms+'"}');
		

	
			
		    function unp(s) {
				return s < 10 ? s.substring(1, s.length) : s;
			}
		    
		    
		    $(".mrt-date").on("click", function(e) {
	            	    e.preventDefault();
	            	    moveEndX = e.originalEvent.changedTouches[0].pageX,
　　　　             moveEndY = e.originalEvent.changedTouches[0].pageY;
         
	         });
			
		
			
			function getResult(result){
	          
		       var result       = eval("(" + result + ")");
		       var date         = result.date;
		       var dateArr      = date.split("-");
		       var year         = dateArr[0];
		       var month        = unp(dateArr[1]);
		       var mrtHourElem  = null;
		       if(year == nowYear){
						 $(".mrt-hour").eq(0).show();
						 $(".mrt-hour").eq(1).hide();
						 mrtHourElem =  $(".mrt-hour").eq(0);
			   }else{
						 $(".mrt-hour").eq(0).hide();
						 $(".mrt-hour").eq(1).show();
						 mrtHourElem =  $(".mrt-hour").eq(1);
			   }
			   
			   setTimeout(function(){
			   	   var mrtDateElem  = $(".mrt-date").children('li').children('span[text="'+year+'"]');
		           var mrtMonthElem = mrtHourElem.children('li').children('span[text="'+month+'"]');
		       
			   	   mrtDateElem.parent("li").addClass("selected");
			       mrtMonthElem.parent("li").addClass("selected");
			       var yearOffsetTop  = mrtDateElem.position().top;
				   var monthOffsetTop = mrtMonthElem.position().top;
		           $("ul.mrt-date").scrollTop(yearOffsetTop-100);
				   mrtHourElem.scrollTop(monthOffsetTop-100);
			   },1000);
		      
	
				
			
				
			   // alert(offsetTop);
			   //alert(currentYearElem.text());
			}
		</script>
	</body>
</html>